<div>
    <link rel="stylesheet" href="../css/instrument.css" />
    <link href='../css/fullcalendar/fullcalendar.min.css' rel='stylesheet' />
    <link href='../css/fullcalendar/fullcalendar.print.min.css' rel='stylesheet' media='print' />
    <script src='../js/fullcalendar/moment.min.js'></script>
    <script src='../js/fullcalendar/fullcalendar.min.js'></script>
    <script src="../js/timepicker/moment.min.js"></script>
    <script src="../js/timepicker/daterangepicker.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/timepicker/daterangepicker.css" />
   <!-- <link rel="stylesheet" type="text/css" href="../css/timepicker/website.css" />
    -->
    <div class="">
        <ul id="id_instrument_tab" class="nav nav-tabs">
            <li class="active">
                <a href="#id_instrument_list_tab" data-toggle="tab"> 仪器列表</a>
            </li>
            <li>
                <a href="#id_instrument_info_tab" data-toggle="tab" id="id_instrument_info_tab_name">仪器详情</a>
            </li>
        </ul>

        <div id="id_group_tab_content" class="tab-content">
            <div id="id_instrument_list_tab" class="tab-pane fade in active">
                </br>

                <h3>仪器列表</h3>
                <form class="form-inline">
                    <div class="form-group">
                        <input type="text" class="form-control" id="id_search_instrument_name" placeholder="仪器名称">
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-control" id="id_search_instrument_number" placeholder="设备编号">
                    </div>
                    <a class="btn btn-default" onclick="searchInstrument()">搜索</a>
                </form>
                <br />
                <div class="table-responsive">
                    <table id="id_user_list" class="table table-striped table-hover">
                        <tr>
                            <td>仪器名称</td>
                            <td>设备编号</td>
                            <td>地址</td>
                            <td>当前使用者</td>
                            <td>负责人</td>
                            <td>操作</td>
                        </tr>
                        <tr v-for="user in users" class="active c_instrument_listitem">
                            <td>{{user.instrument_name}}</td>
                            <td>{{user.location}}</td>
                            <td>{{user.admin}}</td>
                            <td>{{user.admin}}</td>
                            <td>{{user.admin}}</td>
                            <td>
                                <button type="button" class="btn btn-info btn-sm" v-on:click="apply_group">关注</button>
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="page_list">
                    <nav aria-label="Page navigation">
                        <ul class="pagination pagination-lg">
                            <li>
                                <a v-on:click="pagePrevious" aria-label="Previous">
                                    <span aria-hidden="true">&laquo;</span>
                                </a>
                            </li>
                            <li v-for="page_number in pages" v-bind:class="{active : page_number.is_active}" v-on:click="changePage(page_number.page_index)">
                                <a v-bind:class="{hidden : page_number.is_hidden}">{{page_number.page_index}}</a>
                            </li>
                            <li>
                                <a v-on:click="pageNext" aria-label="Next">
                                    <span aria-hidden="true">&raquo;</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>

            <div id="id_instrument_info_tab" class="tab-pane fade">
                <br />
                <br />
                <div class="c_instrument_userinfo row">
                    <div class="c_instrument_avatar_container col-md-3  col-sm-3 col-xs-8 col-xs-offset-1">
                        <img class="img-responsive c_instrument_avatar" src="../img/instrument.jpg" />
                    </div>
                    <div class="c_instrument_infolist_container col-md-7 col-sm-7 col-xs-12">
                        <ul class=" c_instrument_infolist list-group">
                            <li class="c_user_name list-group-item">仪器名称&nbsp;:&emsp;<strong>张德山</strong></li>
                            <li class="c_user_name list-group-item">状态&emsp;&emsp;&nbsp;:&emsp;<strong>可用</strong></li>
                            <li class="c_user_name list-group-item">使用费用&nbsp;:&emsp;<strong>可用</strong></li>
                            <li class="list-group-item">型号&emsp;&emsp;&nbsp;:&emsp;<strong>本科生</strong></li>
                            <li class="list-group-item">仪器编号&nbsp;:&emsp;<strong>本科生</strong></li>
                            <li class="list-group-item">规格&emsp;&emsp;&nbsp;:&emsp;<strong>枸杞生命科学研究课题组</strong></li>
                            <li class="list-group-item">放置地点&nbsp;:&emsp;<strong>西北农林科技大学生命学院</strong></li>
                            <li class="list-group-item">所属单位&nbsp;:&emsp;<strong>计算机141</strong></li>
                            <li class="list-group-item">负责人&emsp;&nbsp;:&emsp;<strong>87655678@out.com</strong></li>
                            <li class="list-group-item">分类号&emsp;&nbsp;:&emsp;<strong>345678</strong></li>
                        </ul>
                        <div class=" c_instrument_infobutton row">
                            <button id="id_instrument_info_follow_btn" class="btn btn-primary col-lg-4 col-sm-5 col-xs-5">关注</button>
                            <button class="btn btn-primary col-lg-4 col-lg-offset-2 col-sm-5 col-xs-5">统计数据</button>
                            <br />
                            <button class="btn btn-danger col-lg-4 col-sm-5 col-xs-5">修改资料</button>
                            <button class="btn btn-danger col-lg-4 col-lg-offset-2 col-sm-5 col-xs-5">故障报告</button></div>
                    </div>
                </div>

                <div>

                </div>

                <ul id="id_instrument_info_tabs" class="nav nav-tabs c_nav_small">
                    <li class="active">
                        <a href="#id_instrument_info_appointment_tab" data-toggle="tab">预约情况</a>
                    </li>
                    <li>
                        <a href="#id_instrument_info_detail_tab" data-toggle="tab">详细信息</a>
                    </li>
                    <li>
                        <a href="#id_instrument_info_history_tab" data-toggle="tab">使用记录</a>
                    </li>
                </ul>

                <div id="id_instrument_info_tabs_content" class="tab-content">
                    <div id="id_instrument_info_appointment_tab" class="tab-pane fade in active">
                        </br>
                        <!--预约情况-->

                        <script>
                            $strNowDate = new Date().format("yyyy-MM-dd");
                            console.log($strNowDate);
                            $(document).ready(function() {
                                $('#calendar').fullCalendar({
                                    header: {
                                        left: 'prev,next today',
                                        center: 'title',
                                        right: 'agendaWeek'
                                    },
                                    defaultDate: $strNowDate,
                                    editable: false,
                                    defaultView: 'agendaWeek',
                                    height: 'auto',
                                    allDaySlot: false,
                                    slotEventOverlap: false,
                                    navLinks: false, // can click day/week names to navigate views
                                    slotLabelFormat: "HH:mm",
                                    eventLimit: false, // allow "more" link when too many events
                                    events: {
                                        url: 'php/get-events.php',
                                        error: function() {
                                            $('#script-warning').show();
                                        }
                                    },
                                    loading: function(bool) {
                                        $('#loading').toggle(bool);
                                    }
                                });

                            });
                            var fixFcalT = setTimeout("fixFullcalendarStyle()", 500);

                            function fixFullcalendarStyle() {
                                console.log(111);
                                if($(".fc-axis").css('width') != "32px") {
                                    $(".fc-axis").css("width", "32px");
                                    clearTimeout(fixFcalT);
                                } else {
                                    fixFcalT = setTimeout("fixFullcalendarStyle()", 500);
                                }
                            }
                        </script>
                        <div class="row">
                            <div class="col-lg-12 col-sm-12 col-xs-12">
                                <div class="row">
                                    <span class="col-lg-8 col-sm-8 col-xs-8"></span>
                                    <button id="id_appointment_button" class="btn btn-info col-lg-2 col-sm-2 col-xs-2 c_btn_appointment" data-toggle="modal" data-target="#id_modal_appointment">+ 预约</button>
                                </div>
                            </div>
                            <div id='calendar' class="col-lg-10 col-sm-12 col-xs-12"></div>
                        </div>

                    </div>
                    <div id="id_instrument_info_detail_tab" class="tab-pane fade">
                        </br>
                        <ul class=" c_instrument_infolist list-group">
                            <li class="c_user_name list-group-item">仪器名称&nbsp;:&emsp;<strong>张德山</strong></li>
                            <li class="list-group-item">型号&emsp;&emsp;&nbsp;:&emsp;<strong>本科生</strong></li>
                            <li class="list-group-item">仪器编号&nbsp;:&emsp;<strong>本科生</strong></li>
                            <li class="list-group-item">规格&emsp;&emsp;&nbsp;:&emsp;<strong>枸杞生命科学研究课题组</strong></li>
                            <li class="list-group-item">放置地点&nbsp;:&emsp;<strong>西北农林科技大学生命学院</strong></li>
                            <li class="list-group-item">所属单位&nbsp;:&emsp;<strong>计算机141</strong></li>
                            <li class="list-group-item">负责人&emsp;&nbsp;:&emsp;<strong>87655678@out.com</strong></li>
                            <li class="list-group-item">制造国家&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">价格&emsp;&emsp;&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">生产厂家&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">出厂日期&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">生产日期&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">技术指标&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">主要功能&nbsp;:&emsp;<strong>345678</strong></li>
                            <li class="list-group-item">主要附件及配置&nbsp;:&emsp;<strong>345678</strong></li>
                        </ul>
                    </div>
                    <div id="id_instrument_info_history_tab" class="tab-pane fade">
                        </br>
                        <!--使用记录-->
                        <div id="id_instrument_history_list_tab" class="tab-pane fade in active">
                            <br />
                            <div class="table-responsive">
                                <table id="id_user_list" class="table table-striped table-hover">
                                    <tr>
                                        <td>使用人姓名</td>
                                        <td>使用时间</td>
                                        <td>使用状态</td>
                                        <td>使用反馈</td>
                                        <td>负责人</td>
                                    </tr>
                                    <tr v-for="user in users" class="active c_instrument_listitem">
                                        <td>{{user.instrument_name}}</td>
                                        <td>{{user.location}}</td>
                                        <td>{{user.admin}}</td>
                                        <td>{{user.admin}}</td>
                                        <td>{{user.admin}}</td>
                                    </tr>
                                </table>
                            </div>
                            <div id="page_list">
                                <nav aria-label="Page navigation">
                                    <ul class="pagination pagination-lg">
                                        <li>
                                            <a v-on:click="pagePrevious" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                        <li v-for="page_number in pages" v-bind:class="{active : page_number.is_active}" v-on:click="changePage(page_number.page_index)">
                                            <a v-bind:class="{hidden : page_number.is_hidden}">{{page_number.page_index}}</a>
                                        </li>
                                        <li>
                                            <a v-on:click="pageNext" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
        </div>
    </div>
</div>
</div>

<div class="modal fade" id="id_modal_appointment" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title">添加预约-<span id="id_modal_appointment_instrument_name">仪器名称</span></h4>
            </div>
            <div class="modal-body">
                <form role="form" class="form-horizontal">
                    <div class="form-group">
                        <label for="id_modal_appointment_input_theme" class="col-sm-3">主题</label>
                        <input type="text" class="col-sm-9 form-control" id="id_modal_appointment_input_theme" placeholder="预约主题">
                    </div>
                    <div class="form-group">
                        <label for="id_modal_appointment_datepicker" class="col-sm-3">预约时间</label>
                        <input id="id_modal_appointment_datepicker" class="col-sm-9 form-control" type="text" name="daterange" value="2018-03-20 1:30 PM - 2018-04-1 2:00 PM" />
                        <script type="text/javascript">
                            $(function() {
                                $('input[name="daterange"]').daterangepicker({
                                    timePicker: true,
                                    timePickerIncrement: 30,
                                    timePicker24Hour: true,
                                    locale: {
                                        format: 'YYYY-MM-DD h:mm A'
                                    }
                                });
                            });
                            Date.prototype.format = function(format) {
                                var o = {
                                    "M+": this.getMonth() + 1, //month
                                    "d+": this.getDate(), //day
                                    "h+": this.getHours(), //hour
                                    "m+": this.getMinutes(), //minute
                                    "s+": this.getSeconds(), //second
                                    "q+": Math.floor((this.getMonth() + 3) / 3), //quarter
                                    "S": this.getMilliseconds() //millisecond
                                }
                                if(/(y+)/.test(format)) {
                                    format = format.replace(RegExp.$1,
                                        (this.getFullYear() + "").substr(4 - RegExp.$1.length))
                                };
                                if(/(A+)/.test(format)) {
                                    var ampm = (this.getHours() >= 12) ? "PM" : "AM";
                                    format = format.replace(RegExp.$1,
                                        ampm)
                                };
                                for(var k in o) {
                                    if(new RegExp("(" + k + ")").test(format))
                                        format = format.replace(RegExp.$1,
                                            RegExp.$1.length == 1 ? o[k] :
                                            ("00" + o[k]).substr(("" + o[k]).length));
                                }
                                return format;
                            }
                            var strStartTime = new Date().format("yyyy-MM-dd h:mm A");
                            var strEndTime = new Date(new Date().getTime() + 4 * 60 * 60 * 1000).format("yyyy-MM-dd h:mm A");
                            $("#id_modal_appointment_datepicker").val(strStartTime + " - " + strEndTime);
                        </script>
                    </div>
                    <div class="form-group">
                        <label for="id_modal_appointment_input_type" class="col-sm-3">类型</label>
                        <select id="id_modal_appointment_input_type" class="col-sm-9 form-control">
                            <option>预约</option>
                            <option>送样</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="id_modal_appointment_input_comment" class="col-sm-3">备注</label>
                        <input type="text" class="col-sm-9 form-control" id="id_modal_appointment_input_comment" placeholder="备注">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary"> 确定预约</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>